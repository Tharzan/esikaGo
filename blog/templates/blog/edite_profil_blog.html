{% load static %}
{% load i18n %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet"   media="(min-width:900px)" href="{% static 'css/menu_desktop.css' %}">
    <link rel="stylesheet"   media="(max-width:900px)" href="{% static 'css/menu_mobile.css' %}">

    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet"   media="(max-width:900px)" href="{% static 'blog/css/edite_profil_blog_mobile.css' %}">
    <link rel="stylesheet"  media="(min-width:900px)"  href="{% static 'blog/css/edite_profil_blog.css' %}">
    
    <title>EsikaApp</title>
</head>
<body>
    <div id="page_">
        {% include 'menu_desktop.html' %}
        {% include 'menu_mobile.html' %}

        <div id="cacher"></div>

        {% include 'petit_menu_ordi.html' %}  

        <div id="contenu">

            <div class="right-panel">


                <img src="{% static 'img/editer_blog.png' %}" alt="">
                
                <p class="about-post">
                    Créez une présentation claire et attractive de votre établissement. 
                    Mettez en valeur les atouts de votre salon ou restaurant pour 
                    capter l'attention et inciter de nouveaux clients à vous découvrir.
                </p>
                       </div>
            <div class="left-panel">
                {% if formError %}
                
                <div class="form-container">
                    
                    <div style="background-color: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; padding: 15px; border-radius: 5px; font-family: sans-serif; display: flex; align-items: center;">
                        <span style="font-size: 24px; margin-right: 10px;">&#9888;</span>
                        <div>
                          <h4 style="margin-top: 0; margin-bottom: 5px;">Erreur de saisie : informations requises</h4>
                          <ul style="margin: 0; padding-left: 20px;">
                            <li>Veillez servir les resultat correctement</li>
                             </ul>
                        </div>
                      </div>
                </div>
                {% endif %}
                <br>
                
<div class="profile-form-container">
    <form action="{% url 'edite_blog' %}" method="post" enctype="multipart/form-data">
        {% csrf_token %}
    <h2>Modifier le Profil d'Accueil</h2>

    <div class="form-section">
        <h3>Informations de contact</h3>
        <div class="form-group">
            <div class="form-field">
                <label for="telephone">Téléphone</label>
                <input type="text" id="telephone" name="contact_telephone" placeholder="Entrez le numéro de téléphone" value="{{ profile.contact_telephone }}"">
            </div>
            <div class="form-field">
                <label for="email">Email</label>
                <input type="email" id="email" name="email" placeholder="Entrez l'adresse email" value="{{ profile.email}}">
            </div>
            <div class="form-field">
                <label for="pays">Pays</label>
                <select name="pays" id="">
                    {% if profile.pays == 'RDC' %}
                    <option value="RDC" selected>RDC</option>
                    <option value="congo_brazza">Congo Brazza</option>
                    {% elif profile.pays == 'congo_brazza'%}
                    <option value="RDC" >RDC</option>
                    <option value="congo_brazza" selected >Congo Brazza</option>
                    {% else %}
                    <option value="RDC">RDC</option>
                    <option value="congo_brazza">Congo Brazza</option>
                    {% endif %}
                </select>
            </div>
            <div class="form-field">
                <label for="ville">Ville</label>
                <input type="text" id="ville" name="ville" required placeholder="Entrez la ville" value="{{ profile.ville }}">
            </div>
            <div class="form-field full-width">
                <label for="description">Presentation de votre Blog</label>
                <textarea id="description"  name="description" placeholder="Écrivez une brève présentation et message de bienvu aux clients...">
                    {{ profile.description }}
                </textarea>
            </div>
        </div>
    </div>
    <div class="form-section">
    
        <h3>Services</h3>
        <div class="services-grid">
           
        {% for key, value in liste_service.items %}
        <div class="service-item">
            {% if key in service %}
            <input type="checkbox" id="{{ key }}" checked name="{{ key }}" value="1">
            {% else %}
            <input type="checkbox" id="{{ key }}" name="{{ key }}" value="1">
            {% endif %}
            <label for="wifi">{{ value }}</label>
        </div>
        
        
        {% endfor %} 
            
        </div>
    </div>


    <div class="form-section">
        <h3>Adresse et location</h3>
        <div class="form-group">
            <div class="form-field">
                <label for="telephone2">commune</label>
                <input type="text" id="telephone2" name="commune" value="{{ profile.commune}}" placeholder="Entrez la commune" required>
            </div>
            <div class="form-field">
                <label for="adresse">Adresse complète</label>
                <input type="text" id="adresse" name="adresse" placeholder="Q. Avenu et N°" value="{{ profile.adresse}}">
            </div>

            

            <div class="media-buttons" >
                <label class="media-button" for="video">
                    <svg for="video" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M21 12L3 21V3L21 12Z" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    Vidéo
                </label>
                <label class="media-button" for="image">
                    <svg for="image" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <rect x="3" y="3" width="18" height="18" rx="2" ry="2" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <circle cx="8.5" cy="8.5" r="1.5" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M21 15L16 10L5 21" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    Image
                </label>
                
            </div>
           
            
        </div>

<div id="Blog_media">
        <div id="apercu-images">
            {% if page.image.image %}
            <p style="width: 150px; height: 100px;overflow: hidden;"><img src="{{ page.image.image.url }}" alt=""></p>
            {% else %}
            Aucune image selectionnée
            {% endif %}
        </div>
        <div id="apercu-video">
            {% if page.image.video %}
            <p style="width: 150px;">
                <video src="{{ page.image.video.url }}" width="150px" height="100px" controls></video>
                </p>
            {% else %}
            Aucune video selectionnée
            {% endif %}
           
        </div>
        <input type="file" id="image" accept="image/*" name="image" hidden>
        <input type="file" accept="video/*" id="video" name="video" hidden>
    </div>



    

    <button type="submit" class="submit-button">Valider</button>
 </form>   
</div>
           
       
            

</div>
        </div>
    </div>
    <script src="{% static 'java/jquery.js' %}"></script>
    <script src="{% static 'java/java_all.js' %}"></script>

    
    <script>
        $(document).ready(function() 
        {
        var svg_profile =$('.svg_profile');

        svg_profile.attr('fill','#f39c12').css('width','40px').css('height','40px').css('background-color','#eee').css('padding','5px');
        





// poste
$('#image').on('change', function(e) {
        // Vider le conteneur de prévisualisation avant d'ajouter de nouvelles images
        $('#apercu-images').empty();
    
        // Récupérer la liste des fichiers sélectionnés
        const files = e.target.files;

        // Vérifier si des fichiers ont été sélectionnés
        if (files) {
            // Parcourir chaque fichier
            $.each(files, function(index, file) {
                // Créer un objet FileReader
                const reader = new FileReader();

                // Définir la fonction qui sera exécutée une fois la lecture terminée
                reader.onload = function(e) {
                    // Créer une balise <img> avec l'URL de données du fichier
                    const image = $('<img>').attr('src', e.target.result)
                    const parent = $('<p>').attr('class', 'apercu-image');
                    parent.append(image);
                    // Ajouter la balise <img> au conteneur de prévisualisation
                    $('#apercu-images').append(parent);
                };

                // Lire le fichier en tant qu'URL de données
                reader.readAsDataURL(file);
            });
        }
    });



$('#video').on('change', function(e) {
        // Vider le conteneur de prévisualisation avant d'ajouter de nouvelles images
        $('#apercu-video').empty();
    
        // Récupérer la liste des fichiers sélectionnés
        const files = e.target.files;

        // Vérifier si des fichiers ont été sélectionnés
        if (files) {
            // Parcourir chaque fichier
            $.each(files, function(index, file) {
                // Créer un objet FileReader
                const reader = new FileReader();

                // Définir la fonction qui sera exécutée une fois la lecture terminée
                reader.onload = function(e) {
                    // Créer une balise <img> avec l'URL de données du fichier
                    const video = $('<video>').attr('controls', 'controls').attr('width','150px').attr('height','150px')
                   source_video =  $('<source>').attr('src', e.target.result)
                   video.append(source_video);
                   
                        const parent = $('<p>').attr('class', 'apercu-video');
                    parent.append(video);
                    // Ajouter la balise <img> au conteneur de prévisualisation
                    $('#apercu-video').append(parent);
                };

                // Lire le fichier en tant qu'URL de données
                reader.readAsDataURL(file);
            });
        }
    });
        });
    </script>
      
</body>
</html>